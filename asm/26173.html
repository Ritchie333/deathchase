<!DOCTYPE html>
<html>
<head>
<title>Deathchase: Routine at 663D</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Deathchase</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="26035.html">65B3</a></span></td>
<td class="up">Up: <a href="../maps/all.html#26173">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="26269.html">669D</a></span></td>
</tr>
</table>
<div class="description">663D: Main loop</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">

</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="26173"></span>663D</td>
<td class="instruction">EI</td>
<td class="comment-11" rowspan="1">Wait for NMI to fire to stop screen flicker</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26174"></span>663E</td>
<td class="instruction">DI</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26175"></span>663F</td>
<td class="instruction">CALL <a href="26269.html">$669D</a></td>
<td class="comment-11" rowspan="1">Check for input</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26178"></span>6642</td>
<td class="instruction">LD A,($5DDE)</td>
<td class="comment-11" rowspan="1">Did we hit a bike?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26181"></span>6645</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26183"></span>6647</td>
<td class="instruction">CALL Z,<a href="26864.html">$68F0</a></td>
<td class="comment-11" rowspan="1">If not, check for fire and act accordingly</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26186"></span>664A</td>
<td class="instruction">CALL <a href="24318.html">$5EFE</a></td>
<td class="comment-11" rowspan="1">Respond to bike movement</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26189"></span>664D</td>
<td class="instruction">CALL <a href="24064.html">$5E00</a></td>
<td class="comment-11" rowspan="1">Move the trees</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26192"></span>6650</td>
<td class="instruction">LD A,($5DD7)</td>
<td class="comment-11" rowspan="1">Are we firing the photon bolt?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26195"></span>6653</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26197"></span>6655</td>
<td class="instruction">CALL NZ,<a href="27176.html">$6A28</a></td>
<td class="comment-11" rowspan="1">If so, adjust its position</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26200"></span>6658</td>
<td class="instruction">CALL <a href="24457.html">$5F89</a></td>
<td class="comment-11" rowspan="1">Print objects on the playing field</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26203"></span>665B</td>
<td class="instruction">LD A,($5DDE)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26206"></span>665E</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26208"></span>6660</td>
<td class="instruction">CALL NZ,<a href="27107.html">$69E3</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26211"></span>6663</td>
<td class="instruction">CALL <a href="27085.html">$69CD</a></td>
<td class="comment-11" rowspan="1">Toggle the range indicator</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26214"></span>6666</td>
<td class="instruction">CALL <a href="27047.html">$69A7</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26217"></span>6669</td>
<td class="instruction">CALL <a href="25075.html">$61F3</a></td>
<td class="comment-11" rowspan="1">Recalculate where enemy bikes should be</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26220"></span>666C</td>
<td class="instruction">LD A,($5DC6)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26223"></span>666F</td>
<td class="instruction">LD HL,$5DC7</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26226"></span>6672</td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26227"></span>6673</td>
<td class="instruction">JR NZ,$667A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26229"></span>6675</td>
<td class="instruction">LD A,($5DC5)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26232"></span>6678</td>
<td class="instruction">ADD A,(HL)</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26233"></span>6679</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="26234"></span>667A</td>
<td class="instruction">CALL <a href="26365.html">$66FD</a></td>
<td class="comment-11" rowspan="1">Check to see if we hit a tree</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26237"></span>667D</td>
<td class="instruction">CALL <a href="26566.html">$67C6</a></td>
<td class="comment-11" rowspan="1">Move the bikes nearer or further depending on speed</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26240"></span>6680</td>
<td class="instruction">CALL <a href="25402.html">$633A</a></td>
<td class="comment-11" rowspan="1">Move a plan or tank if necessary</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26243"></span>6683</td>
<td class="instruction">LD A,($5DDE)</td>
<td class="comment-11" rowspan="1">Did we hit a bike?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26246"></span>6686</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26248"></span>6688</td>
<td class="instruction">JR NZ,$669A</td>
<td class="comment-11" rowspan="1">Move on if we did</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26250"></span>668A</td>
<td class="instruction">LD A,($5DD7)</td>
<td class="comment-11" rowspan="1">Is the photon bolt being fired?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26253"></span>668D</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26255"></span>668F</td>
<td class="instruction">JR Z,$669A</td>
<td class="comment-11" rowspan="1">Skip if it isn't</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26257"></span>6691</td>
<td class="instruction">CALL <a href="26713.html">$6859</a></td>
<td class="comment-11" rowspan="1">Draw the trail of the photon bolt</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26260"></span>6694</td>
<td class="instruction">CALL <a href="27176.html">$6A28</a></td>
<td class="comment-11" rowspan="1">Move it left or right appropriately</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="26263"></span>6697</td>
<td class="instruction">CALL <a href="26626.html#26643">$6813</a></td>
<td class="comment-11" rowspan="1">See if anything has been hit?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="26266"></span>669A</td>
<td class="instruction">JP $663D</td>
<td class="comment-11" rowspan="1">Back to start</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="26035.html">65B3</a></span></td>
<td class="up">Up: <a href="../maps/all.html#26173">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="26269.html">669D</a></span></td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">Copyright Mervyn Estcourt 1983. This disassembly by Ritchie Swann, 2018.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 7.0.</div>
</footer>
</body>
</html>