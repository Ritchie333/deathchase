<!DOCTYPE html>
<html>
<head>
<title>Deathchase: Routine at 6113</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Deathchase</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="24769.html">60C1</a></span></td>
<td class="up">Up: <a href="../maps/all.html#24851">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="24912.html">6150</a></span></td>
</tr>
</table>
<div class="description">6113: Switch from DAY to NIGHT</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="25291.html">62CB</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24851"></span>6113</td>
<td class="instruction">LD B,$05</td>
<td class="comment-11" rowspan="1">Five colours</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24853"></span>6115</td>
<td class="instruction">LD C,$04</td>
<td class="comment-11" rowspan="1">Start off cyan</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24855"></span>6117</td>
<td class="instruction">LD HL,$5841</td>
<td class="comment-11" rowspan="1">Point to the attribute buffer</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24858"></span>611A</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24859"></span>611B</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24860"></span>611C</td>
<td class="instruction">LD A,C</td>
<td class="comment-11" rowspan="1">Get the next colour?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24861"></span>611D</td>
<td class="instruction">CP $04</td>
<td class="comment-11" rowspan="1">Is it black?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24863"></span>611F</td>
<td class="instruction">JR Z,$6140</td>
<td class="comment-11" rowspan="1">Jump forward if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24865"></span>6121</td>
<td class="instruction">SLA C</td>
<td class="comment-11" rowspan="1">Shift the colour into PAPER bit position</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24867"></span>6123</td>
<td class="instruction">SLA C</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24869"></span>6125</td>
<td class="instruction">SLA C</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24871"></span>6127</td>
<td class="instruction">LD B,$0A</td>
<td class="comment-11" rowspan="1">10 rows</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24873"></span>6129</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24874"></span>612A</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24875"></span>612B</td>
<td class="instruction">LD B,$1E</td>
<td class="comment-11" rowspan="1">30 columns</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24877"></span>612D</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Get the next attribute</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24878"></span>612E</td>
<td class="instruction">AND $C7</td>
<td class="comment-11" rowspan="2">Turn off PAPER bits and swap them for current colour</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24880"></span>6130</td>
<td class="instruction">OR C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24881"></span>6131</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">Put the attribute back</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24882"></span>6132</td>
<td class="instruction">INC HL</td>
<td class="comment-11" rowspan="1">Move to next column</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24883"></span>6133</td>
<td class="instruction">DJNZ $612D</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24885"></span>6135</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24886"></span>6136</td>
<td class="instruction">LD DE,$0020</td>
<td class="comment-11" rowspan="1">Move to next row</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24889"></span>6139</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24890"></span>613A</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24891"></span>613B</td>
<td class="instruction">DJNZ $6129</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24893"></span>613D</td>
<td class="instruction">CALL <a href="24746.html">$60AA</a></td>
<td class="comment-11" rowspan="1">Play an ascending sound</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><span id="24896"></span>6140</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24897"></span>6141</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24898"></span>6142</td>
<td class="instruction">DEC C</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24899"></span>6143</td>
<td class="instruction">DJNZ $611A</td>
<td class="comment-11" rowspan="1">Next colour</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24901"></span>6145</td>
<td class="instruction">LD C,$00</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24903"></span>6147</td>
<td class="instruction">CALL <a href="25335.html">$62F7</a></td>
<td class="comment-11" rowspan="1">Flip background colour on huge trees</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24906"></span>614A</td>
<td class="instruction">LD DE,$6B44</td>
<td class="comment-11" rowspan="1"><a href="27460.html">6B44</a> = "NIGHT PATROL"</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><span id="24909"></span>614D</td>
<td class="instruction">JP <a href="24769.html#24840">$6108</a></td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a href="24769.html">60C1</a></span></td>
<td class="up">Up: <a href="../maps/all.html#24851">Map</a></td>
<td class="next"><span class="next-1">Next: <a href="24912.html">6150</a></span></td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">Copyright Mervyn Estcourt 1983. This disassembly by Ritchie Swann, 2018.</div>
<div class="created">Created using <a href="http://skoolkit.ca/">SkoolKit</a> 7.0.</div>
</footer>
</body>
</html>